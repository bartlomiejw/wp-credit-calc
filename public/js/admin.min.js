import{d as z,r as E,a as M,c as A,t as K,n as N,E as q,b as B,e as I,f as P,g as W,h as R,i as T,j as F,o as n,k as d,l,m as g,w as m,F as b,p as v,q as x,s as J,u as k,v as V,x as D,y as G,z as H,A as Z,B as Q}from"./elementPlus.min.js";import{_ as U,c as X,a as Y,i as ee}from"./index.min.js";const te=e=>{const t=window.location.href,a=t.indexOf("admin.html")>0,o=document.querySelector(a?".wp-menu-open":`#toplevel_page_${e}`),c=t.substr(t.indexOf(a?"#/":"admin.php"));if(o){o.addEventListener("click",function(p){const f=p.target,S=this.querySelectorAll("li");for(let h=0;h<S.length;h++){let y=S[h];y!==p.target.parentElement?y.classList.remove("current"):f.parentElement.classList.add("current")}});const r=o.querySelectorAll(".current");for(let p=0;p<r.length;p++)r[p].classList.remove("current");let u=o.querySelector(`.wp-submenu a[href="${c}"`);!a&&c.endsWith("#/")&&(u=o.querySelector(".wp-submenu a.wp-first-item")),u&&(console.log(u),u.parentElement.classList.add("current"))}};const se=z({name:"Settings",setup(){const e={},t=E({...e}),a=E({actionKey:0,loaded:!1}),o=E({sections:{},options:{}}),c=M(!1),r=A(()=>{const u=JSON.stringify(t),p=JSON.stringify(e);return a.actionKey=a.actionKey+1,u===p});return{settings:t,oldSettings:e,hasChanged:r,endpoints:{settings:""},ui:a,structure:o,hasLoaded:c}},methods:{async doSave(){try{let e=K(this.settings);const t=await this.axios.post(this.endpoints.settings,e);if(t.status===200){ElMessage({message:"Twoje ustawienia zosta\u0142y zapisane.",type:"success"});const o=this.$win.vue_wp_plugin_config_admin.settings||{},c={...this.settings};Object.keys(c).forEach(r=>{this.oldSettings[r]=c[r],o[r]=c[r]}),this.ui.actionKey=this.ui.actionKey+1}else ElMessage.error("Odpowied\u017A wordpress z b\u0142\u0119dem. "+JSON.stringify(t,null,2))}catch(e){ElMessage.error("Odpowied\u017A serwera z b\u0142\u0119dem. "+e.message)}},getOptions(e){const t={...this.structure.options},a=[];return Object.keys(t).forEach(o=>{const c=t[o];c.section===e&&(c.id=o,a.push(c))}),a},doCancel(){const e=this.oldSettings;Object.keys(e).forEach(t=>{this.oldSettings[t]=e[t],this.settings[t]=e[t]})},async doLoad(){await N();const e=this.$win.vue_wp_plugin_config_admin;this.$win.$appConfig.nonce||(this.$win.$appConfig.nonce=e.rest.nonce);const t=e.settingStructure;this.structure.sections=t.sections,this.structure.options=t.options;const a=e.settings||{};this.endpoints=e.rest.endpoints,Object.keys(a).forEach(o=>{this.oldSettings[o]=a[o],this.settings[o]=a[o]}),this.hasLoaded=!0,this.$forceUpdate()}},beforeMount(){const e=this;if(e.$win&&e.$win.vue_wp_plugin_config_admin){e.doLoad();return}document.onreadystatechange=async()=>{document.readyState==="complete"&&this.doLoad()}}});const oe=e=>(D("data-v-dbb5159c"),e=e(),G(),e),ne={key:0,class:"app-settings w-full flex flex-wrap mx-auto"},ae={class:"w-full md:w-1/5 pt-4"},ie={class:"w-full sticky inset-0 lg:h-auto overflow-x-hidden overflow-y-auto lg:overflow-y-hidden lg:block mt-0 my-2 lg:my-0 border border-gray-400 lg:border-transparent bg-white shadow lg:shadow-none lg:bg-transparent z-20"},le=["href"],de={class:"font-bold"},ce={class:"space-x-3 flex justify-end pt-2"},re=oe(()=>l("div",{class:"pt-2"},[l("p",null,[l("strong",null,"Widget - strona")]),l("code",{class:"m-auto block w-100"},"[creditcalc-vue-app view='ExchangeRates']")],-1)),ue={class:"w-full md:w-4/5 min-h-screen"},pe={class:"ml-3"},ge=["id"],he={class:"p-8 mt-6 lg:mt-0 rounded shadow bg-white"},_e={class:"font-sans font-bold break-normal text-gray-700 pb-4 text-xl w-full"},me={class:"md:flex mb-6"},fe={class:"md:w-3/5"},ye={class:"block text-gray-600 font-bold md:text-left mb-3 md:mb-0 pr-4",for:"my-checkbox"},we={class:"py-2 text-sm text-gray-600"},be={class:"md:w-2/5"},ve={key:0},Se={key:1},Ve={key:2},$e={key:3},Ee={key:4},ke={key:5};function Ce(e,t,a,o,c,r){const u=q,p=B,f=I,S=P,h=W,y=R,O=T,j=F;return e.hasLoaded?(n(),d("div",ne,[l("aside",ae,[l("div",ie,[g(p,{"default-active":"1",class:"rounded shadow bg-white"},{default:m(()=>[(n(!0),d(b,null,v(e.structure.sections,(w,_)=>(n(),k(u,{key:`el-menu-item-${_}`,index:_},{default:m(()=>[l("a",{href:`/settings${_}`},[l("span",de,V(w),1)],8,le)]),_:2},1032,["index"]))),128))]),_:1}),l("div",ce,[g(f,{onClick:t[0]||(t[0]=w=>e.doSave()),style:{width:"100px"},type:"primary",size:"large",disabled:e.hasChanged,"data-rerendered":e.ui.actionKey},{default:m(()=>[x(" Zapisz ")]),_:1},8,["disabled","data-rerendered"]),g(f,{onClick:t[1]||(t[1]=w=>e.doCancel()),style:{width:"100px"},type:"danger",size:"large",disabled:e.hasChanged,"data-rerendered":e.ui.actionKey},{default:m(()=>[x(" Anuluj ")]),_:1},8,["disabled","data-rerendered"])]),re])]),l("section",ue,[l("div",pe,[(n(!0),d(b,null,v(e.structure.sections,(w,_)=>(n(),d("div",{id:_,class:"pt-4"},[l("div",he,[l("h2",_e,V(w),1),(n(!0),d(b,null,v(e.getOptions(_),s=>(n(),d("div",me,[l("div",fe,[l("label",ye,V(s.name),1),l("p",we,V(s.description),1)]),l("div",be,[s.type==="toggle"?(n(),d("div",ve,[g(S,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large"},null,8,["modelValue","onUpdate:modelValue"])])):s.type==="dropdownMultiselect"?(n(),d("div",Se,[g(y,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large",multiple:"","collapse-tags":"",placeholder:"Wybierz"},{default:m(()=>[(n(!0),d(b,null,v(s.options,(i,$)=>(n(),k(h,{key:$,label:i.currency,value:i.code},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):s.type==="dropdown"?(n(),d("div",Ve,[g(y,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large",placeholder:"Wybierz"},{default:m(()=>[(n(!0),d(b,null,v(s.options,(i,$)=>(n(),k(h,{key:$,label:i.currency,value:i.code},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):["textarea"].indexOf(s.type)>-1?(n(),d("div",$e,[g(O,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,rows:5,size:"large",type:"textarea",placeholder:"Please input"},null,8,["modelValue","onUpdate:modelValue"])])):s.type==="color"?(n(),d("div",Ee,[g(j,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i},null,8,["modelValue","onUpdate:modelValue"])])):(n(),d("div",ke,[g(O,{modelValue:e.settings[s.id],"onUpdate:modelValue":i=>e.settings[s.id]=i,size:"large",placeholder:"Please input"},null,8,["modelValue","onUpdate:modelValue"])]))])]))),256))])],8,ge))),256))])])])):J("",!0)}const L=U(se,[["render",Ce],["__scopeId","data-v-dbb5159c"]]),Oe=z({components:{Settings:L},mounted(){const e=H("pluginConfig",{});te(e.prefix||"vue-app")}}),xe={class:"main-wrapper"};function ze(e,t,a,o,c,r){const u=Z("Settings");return n(),d("div",xe,[g(u)])}const Ue=U(Oe,[["render",ze]]),Le=[{path:"/",component:L}],je=X({history:Y(),routes:Le});const C=Q(Ue);C.use(je);setTimeout(()=>{ee(C,"vue_wp_plugin_config_admin"),C.mount("#vue-admin-app")},200);
